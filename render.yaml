services:
  # -------------------------
  # MinIO S3 Server (Public)
  # -------------------------
  - type: web
    name: minio-server
    env: docker
    rootDir: server
    plan: starter
    healthCheckPath: /minio/health/live
    disk:
      name: minio-data
      mountPath: /data
      sizeGB: 10
    envVars:
      - key: MINIO_ROOT_USER
        generateValue: true
      - key: MINIO_ROOT_PASSWORD
        generateValue: true

      # Optional but commonly useful for console redirects and external clients:
      # - key: MINIO_SERVER_URL
      #   value: "https://YOUR_MINIO_SERVER_PUBLIC_URL"
      # - key: MINIO_BROWSER_REDIRECT_URL
      #   value: "https://YOUR_MINIO_CONSOLE_PUBLIC_URL"

  # -------------------------
  # MinIO Console (Public via Nginx proxy)
  # -------------------------
  - type: web
    name: minio-console
    env: docker
    rootDir: console
    plan: starter
    envVars:
      # Nginx listens on Render-provided $PORT automatically, so don't hardcode it.

      # Internal host of minio-server on Render private network
      - key: MINIO_HOST
        fromService:
          name: minio-server
          type: web
          property: host

      # Console port inside minio-server container
      - key: MINIO_CONSOLE_PORT
        value: "9090"
